"use strict";(self["webpackChunkprject"]=self["webpackChunkprject"]||[]).push([[566],{5566:function(e,a,l){l.r(a),l.d(a,{default:function(){return g}});var t=l(6768),r=l(4232);const o={class:"user-list"},n={class:"card-header"};function u(e,a,l,u,d,s){const i=(0,t.g2)("el-button"),p=(0,t.g2)("el-input"),m=(0,t.g2)("el-form-item"),b=(0,t.g2)("el-form"),c=(0,t.g2)("el-table-column"),g=(0,t.g2)("el-tag"),f=(0,t.g2)("el-table"),h=(0,t.g2)("el-pagination"),k=(0,t.g2)("el-card"),F=(0,t.g2)("el-option"),y=(0,t.g2)("el-select"),V=(0,t.g2)("el-input-number"),v=(0,t.g2)("el-dialog"),C=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(k,null,{header:(0,t.k6)(()=>[(0,t.Lk)("div",n,[a[14]||(a[14]=(0,t.Lk)("span",null,"用户管理",-1)),(0,t.bF)(i,{type:"primary",onClick:u.handleAdd},{default:(0,t.k6)(()=>[...a[13]||(a[13]=[(0,t.eW)("新增用户",-1)])]),_:1},8,["onClick"])])]),default:(0,t.k6)(()=>[(0,t.bF)(b,{inline:!0,model:u.queryForm,class:"search-form"},{default:(0,t.k6)(()=>[(0,t.bF)(m,{label:"用户ID"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.queryForm.id,"onUpdate:modelValue":a[0]||(a[0]=e=>u.queryForm.id=e),placeholder:"请输入用户ID",clearable:""},null,8,["modelValue"])]),_:1}),(0,t.bF)(m,{label:"用户名"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.queryForm.username,"onUpdate:modelValue":a[1]||(a[1]=e=>u.queryForm.username=e),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),(0,t.bF)(m,null,{default:(0,t.k6)(()=>[(0,t.bF)(i,{type:"primary",onClick:u.handleSearch},{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("查询",-1)])]),_:1},8,["onClick"]),(0,t.bF)(i,{onClick:u.handleReset},{default:(0,t.k6)(()=>[...a[16]||(a[16]=[(0,t.eW)("重置",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),(0,t.bo)(((0,t.uX)(),(0,t.Wv)(f,{data:u.tableData,border:""},{default:(0,t.k6)(()=>[(0,t.bF)(c,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(c,{prop:"username",label:"用户名"}),(0,t.bF)(c,{prop:"userType",label:"用户类型"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,r.v_)(u.getUserTypeText(e.userType)),1)]),_:1}),(0,t.bF)(c,{prop:"phone",label:"手机号"}),(0,t.bF)(c,{prop:"email",label:"邮箱"}),(0,t.bF)(c,{prop:"status",label:"状态"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(g,{type:1===e.status?"success":"danger"},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(u.getStatusText(e.status)),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(c,{prop:"lastLoginTime",label:"最后登录时间"}),(0,t.bF)(c,{label:"操作",width:"200",fixed:"right"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(i,{type:"primary",size:"small",onClick:a=>u.handleEdit(e)},{default:(0,t.k6)(()=>[...a[17]||(a[17]=[(0,t.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,t.bF)(i,{type:"danger",size:"small",onClick:a=>u.handleDelete(e)},{default:(0,t.k6)(()=>[...a[18]||(a[18]=[(0,t.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[C,u.loading]]),(0,t.bF)(h,{"current-page":u.pagination.current,"onUpdate:currentPage":a[2]||(a[2]=e=>u.pagination.current=e),"page-size":u.pagination.size,"onUpdate:pageSize":a[3]||(a[3]=e=>u.pagination.size=e),total:u.pagination.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:u.handleSizeChange,onCurrentChange:u.handleCurrentChange,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),_:1}),(0,t.bF)(v,{modelValue:u.dialogVisible,"onUpdate:modelValue":a[12]||(a[12]=e=>u.dialogVisible=e),title:u.dialogTitle,width:"600px",onClose:u.handleDialogClose},{footer:(0,t.k6)(()=>[(0,t.bF)(i,{onClick:a[11]||(a[11]=e=>u.dialogVisible=!1)},{default:(0,t.k6)(()=>[...a[19]||(a[19]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(i,{type:"primary",onClick:u.handleSubmit},{default:(0,t.k6)(()=>[...a[20]||(a[20]=[(0,t.eW)("确定",-1)])]),_:1},8,["onClick"])]),default:(0,t.k6)(()=>[(0,t.bF)(b,{model:u.formData,rules:u.rules,ref:"formRef","label-width":"100px"},{default:(0,t.k6)(()=>[(0,t.bF)(m,{label:"用户名",prop:"username"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.formData.username,"onUpdate:modelValue":a[4]||(a[4]=e=>u.formData.username=e)},null,8,["modelValue"])]),_:1}),u.formData.id?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(m,{key:0,label:"密码",prop:"passwordHash"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.formData.passwordHash,"onUpdate:modelValue":a[5]||(a[5]=e=>u.formData.passwordHash=e),type:"password"},null,8,["modelValue"])]),_:1})),(0,t.bF)(m,{label:"用户类型",prop:"userType"},{default:(0,t.k6)(()=>[(0,t.bF)(y,{modelValue:u.formData.userType,"onUpdate:modelValue":a[6]||(a[6]=e=>u.formData.userType=e),placeholder:"请选择"},{default:(0,t.k6)(()=>[(0,t.bF)(F,{label:"患者",value:1}),(0,t.bF)(F,{label:"家属",value:2}),(0,t.bF)(F,{label:"护工",value:3}),(0,t.bF)(F,{label:"医护人员",value:4}),(0,t.bF)(F,{label:"系统管理员",value:9})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(m,{label:"手机号",prop:"phone"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.formData.phone,"onUpdate:modelValue":a[7]||(a[7]=e=>u.formData.phone=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(m,{label:"邮箱",prop:"email"},{default:(0,t.k6)(()=>[(0,t.bF)(p,{modelValue:u.formData.email,"onUpdate:modelValue":a[8]||(a[8]=e=>u.formData.email=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(m,{label:"状态",prop:"status"},{default:(0,t.k6)(()=>[(0,t.bF)(y,{modelValue:u.formData.status,"onUpdate:modelValue":a[9]||(a[9]=e=>u.formData.status=e),placeholder:"请选择"},{default:(0,t.k6)(()=>[(0,t.bF)(F,{label:"正常",value:1}),(0,t.bF)(F,{label:"禁用",value:2}),(0,t.bF)(F,{label:"冻结",value:3})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(m,{label:"关联病人ID",prop:"patientId"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:u.formData.patientId,"onUpdate:modelValue":a[10]||(a[10]=e=>u.formData.patientId=e),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","onClose"])])}var d=l(144),s=l(1219),i=l(2933),p=l(466),m={name:"UserList",setup(){const e=(0,d.KR)(!1),a=(0,d.KR)(!1),l=(0,d.KR)(null),r=(0,d.KR)([]),o=(0,d.Kh)({id:"",username:""}),n=(0,d.Kh)({id:null,username:"",passwordHash:"",userType:null,phone:"",email:"",status:1,patientId:null}),u=(0,d.Kh)({current:1,size:10,total:0}),m={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],userType:[{required:!0,message:"请选择用户类型",trigger:"change"}]},b=e=>{const a={1:"患者",2:"家属",3:"护工",4:"医护人员",9:"系统管理员"};return a[e]||"未知"},c=e=>{const a={1:"正常",2:"禁用",3:"冻结"};return a[e]||"未知"},g=(0,d.KR)("新增用户"),f=async()=>{e.value=!0;try{const e={current:u.current,size:u.size,...o.id&&{id:o.id},...o.username&&{username:o.username}},a=await p.i$.getPage(e);200!==a.code&&a.code||(r.value=a.data?.records||[],u.total=a.data?.total||0)}catch(a){s.nk.error("加载数据失败")}finally{e.value=!1}},h=()=>{u.current=1,f()},k=()=>{o.id="",o.username="",h()},F=()=>{g.value="新增用户",Object.assign(n,{id:null,username:"",passwordHash:"",userType:null,phone:"",email:"",status:1,patientId:null}),a.value=!0},y=async e=>{g.value="编辑用户";try{const l=await p.i$.getById(e.id);200!==l.code&&l.code||(Object.assign(n,l.data||e),a.value=!0)}catch(l){s.nk.error("获取用户信息失败")}},V=e=>{i.s.confirm("确定要删除该用户吗？","提示",{type:"warning"}).then(async()=>{try{await p.i$.removeById(e.id),s.nk.success("删除成功"),f()}catch(a){s.nk.error("删除失败")}}).catch(()=>{})},v=async()=>{l.value&&await l.value.validate(async e=>{if(e)try{await p.i$.saveOrUpdate(n),s.nk.success("操作成功"),a.value=!1,f()}catch(l){s.nk.error("操作失败")}})},C=()=>{l.value?.resetFields()},_=()=>{f()},D=()=>{f()};return(0,t.sV)(()=>{f()}),{loading:e,dialogVisible:a,dialogTitle:g,formRef:l,tableData:r,queryForm:o,formData:n,pagination:u,rules:m,getUserTypeText:b,getStatusText:c,handleSearch:h,handleReset:k,handleAdd:F,handleEdit:y,handleDelete:V,handleSubmit:v,handleDialogClose:C,handleSizeChange:_,handleCurrentChange:D}}},b=l(1241);const c=(0,b.A)(m,[["render",u],["__scopeId","data-v-709e92a5"]]);var g=c}}]);
//# sourceMappingURL=566.f3039f1f.js.map