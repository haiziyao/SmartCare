"use strict";(self["webpackChunkprject"]=self["webpackChunkprject"]||[]).push([[910],{7910:function(e,a,l){l.r(a),l.d(a,{default:function(){return g}});var t=l(6768),r=l(4232);const o={class:"patient-list"},n={class:"card-header"};function d(e,a,l,d,i,u){const p=(0,t.g2)("el-button"),s=(0,t.g2)("el-table-column"),m=(0,t.g2)("el-table"),b=(0,t.g2)("el-pagination"),c=(0,t.g2)("el-card"),g=(0,t.g2)("el-input"),f=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-col"),k=(0,t.g2)("el-option"),F=(0,t.g2)("el-select"),v=(0,t.g2)("el-row"),V=(0,t.g2)("el-date-picker"),C=(0,t.g2)("el-input-number"),y=(0,t.g2)("el-form"),D=(0,t.g2)("el-dialog"),_=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(c,null,{header:(0,t.k6)(()=>[(0,t.Lk)("div",n,[a[16]||(a[16]=(0,t.Lk)("span",null,"病人管理",-1)),(0,t.bF)(p,{type:"primary",onClick:d.handleAdd},{default:(0,t.k6)(()=>[...a[15]||(a[15]=[(0,t.eW)("新增病人",-1)])]),_:1},8,["onClick"])])]),default:(0,t.k6)(()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(m,{data:d.tableData,border:""},{default:(0,t.k6)(()=>[(0,t.bF)(s,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(s,{prop:"patientName",label:"病人姓名"}),(0,t.bF)(s,{prop:"gender",label:"性别"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,r.v_)(1===e.gender?"男":2===e.gender?"女":"未知"),1)]),_:1}),(0,t.bF)(s,{prop:"birthDate",label:"出生日期"}),(0,t.bF)(s,{prop:"phone",label:"联系电话"}),(0,t.bF)(s,{prop:"roomId",label:"房间ID"}),(0,t.bF)(s,{prop:"patientStatus",label:"健康状态"}),(0,t.bF)(s,{prop:"eventGrade",label:"风险等级"}),(0,t.bF)(s,{label:"操作",width:"250",fixed:"right"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(p,{type:"primary",size:"small",onClick:a=>d.handleEdit(e)},{default:(0,t.k6)(()=>[...a[17]||(a[17]=[(0,t.eW)("编辑",-1)])]),_:1},8,["onClick"]),(0,t.bF)(p,{type:"success",size:"small",onClick:a=>d.handleViewCaregivers(e)},{default:(0,t.k6)(()=>[...a[18]||(a[18]=[(0,t.eW)("监护人",-1)])]),_:1},8,["onClick"]),(0,t.bF)(p,{type:"danger",size:"small",onClick:a=>d.handleDelete(e)},{default:(0,t.k6)(()=>[...a[19]||(a[19]=[(0,t.eW)("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[_,d.loading]]),(0,t.bF)(b,{"current-page":d.pagination.current,"onUpdate:currentPage":a[0]||(a[0]=e=>d.pagination.current=e),"page-size":d.pagination.size,"onUpdate:pageSize":a[1]||(a[1]=e=>d.pagination.size=e),total:d.pagination.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),_:1}),(0,t.bF)(D,{modelValue:d.dialogVisible,"onUpdate:modelValue":a[13]||(a[13]=e=>d.dialogVisible=e),title:d.dialogTitle,width:"700px",onClose:d.handleDialogClose},{footer:(0,t.k6)(()=>[(0,t.bF)(p,{onClick:a[12]||(a[12]=e=>d.dialogVisible=!1)},{default:(0,t.k6)(()=>[...a[20]||(a[20]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(p,{type:"primary",onClick:d.handleSubmit},{default:(0,t.k6)(()=>[...a[21]||(a[21]=[(0,t.eW)("确定",-1)])]),_:1},8,["onClick"])]),default:(0,t.k6)(()=>[(0,t.bF)(y,{model:d.formData,rules:d.rules,ref:"formRef","label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(v,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"病人姓名",prop:"patientName"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.patientName,"onUpdate:modelValue":a[2]||(a[2]=e=>d.formData.patientName=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"性别",prop:"gender"},{default:(0,t.k6)(()=>[(0,t.bF)(F,{modelValue:d.formData.gender,"onUpdate:modelValue":a[3]||(a[3]=e=>d.formData.gender=e),placeholder:"请选择"},{default:(0,t.k6)(()=>[(0,t.bF)(k,{label:"男",value:1}),(0,t.bF)(k,{label:"女",value:2})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,t.bF)(v,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"出生日期",prop:"birthDate"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:d.formData.birthDate,"onUpdate:modelValue":a[4]||(a[4]=e=>d.formData.birthDate=e),type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DDTHH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"身份证号",prop:"idCard"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.idCard,"onUpdate:modelValue":a[5]||(a[5]=e=>d.formData.idCard=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,t.bF)(v,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"联系电话",prop:"phone"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.phone,"onUpdate:modelValue":a[6]||(a[6]=e=>d.formData.phone=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"紧急联系人",prop:"emergencyContactPhone"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.emergencyContactPhone,"onUpdate:modelValue":a[7]||(a[7]=e=>d.formData.emergencyContactPhone=e)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,t.bF)(f,{label:"家庭住址",prop:"homeAddress"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.homeAddress,"onUpdate:modelValue":a[8]||(a[8]=e=>d.formData.homeAddress=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(v,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"房间ID",prop:"roomId"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:d.formData.roomId,"onUpdate:modelValue":a[9]||(a[9]=e=>d.formData.roomId=e),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),(0,t.bF)(h,{span:12},{default:(0,t.k6)(()=>[(0,t.bF)(f,{label:"设备ID",prop:"equipmentId"},{default:(0,t.k6)(()=>[(0,t.bF)(C,{modelValue:d.formData.equipmentId,"onUpdate:modelValue":a[10]||(a[10]=e=>d.formData.equipmentId=e),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,t.bF)(f,{label:"备注",prop:"remark"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:d.formData.remark,"onUpdate:modelValue":a[11]||(a[11]=e=>d.formData.remark=e),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","onClose"]),(0,t.bF)(D,{modelValue:d.caregiverDialogVisible,"onUpdate:modelValue":a[14]||(a[14]=e=>d.caregiverDialogVisible=e),title:"监护人列表",width:"800px"},{default:(0,t.k6)(()=>[(0,t.bF)(m,{data:d.caregiverList,border:""},{default:(0,t.k6)(()=>[(0,t.bF)(s,{prop:"caregiverName",label:"姓名"}),(0,t.bF)(s,{prop:"phone",label:"电话"}),(0,t.bF)(s,{prop:"relationship",label:"关系"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,r.v_)(d.getRelationshipText(e.relationship)),1)]),_:1}),(0,t.bF)(s,{label:"操作",width:"150"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(p,{type:"danger",size:"small",onClick:a=>d.handleRemoveCaregiver(e)},{default:(0,t.k6)(()=>[...a[22]||(a[22]=[(0,t.eW)(" 移除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}l(8111),l(7588);var i=l(144),u=l(1219),p=l(2933),s=l(466),m={name:"PatientList",setup(){const e=(0,i.KR)(!1),a=(0,i.KR)(!1),l=(0,i.KR)(!1),r=(0,i.KR)(null),o=(0,i.KR)([]),n=(0,i.KR)([]),d=(0,i.KR)(null),m=(0,i.Kh)({id:null,patientName:"",gender:null,birthDate:"",idCard:"",phone:"",emergencyContactPhone:"",homeAddress:"",roomId:null,equipmentId:null,staffId:null,equipmentStatus:null,patientStatus:null,eventGrade:null,remark:""}),b=(0,i.Kh)({current:1,size:10,total:0}),c={patientName:[{required:!0,message:"请输入病人姓名",trigger:"blur"}]},g=(0,i.KR)("新增病人"),f=e=>{const a={1:"父母",2:"子女",3:"配偶",4:"亲属",5:"其他"};return a[e]||"未知"},h=async()=>{e.value=!0;try{const e=await s.sQ.getPage({current:b.current,size:b.size});200!==e.code&&e.code||(o.value=e.data?.records||[],b.total=e.data?.total||0)}catch(a){u.nk.error("加载数据失败")}finally{e.value=!1}},k=()=>{g.value="新增病人",Object.keys(m).forEach(e=>{"string"===typeof m[e]?m[e]="":m[e]=null}),m.id=null,a.value=!0},F=async e=>{g.value="编辑病人";try{const l=await s.sQ.getById(e.id);200!==l.code&&l.code||(Object.assign(m,l.data||e),a.value=!0)}catch(l){u.nk.error("获取病人信息失败")}},v=async e=>{d.value=e.id;try{const a=await s.Fl.listCaregiverByPatientId(e.id);200!==a.code&&a.code||(n.value=Array.isArray(a.data)?a.data:[],l.value=!0)}catch(a){u.nk.error("获取监护人列表失败")}},V=e=>{p.s.confirm("确定要移除该监护人吗？","提示",{type:"warning"}).then(async()=>{try{await s.Fl.remove(d.value,e.id),u.nk.success("移除成功"),v({id:d.value})}catch(a){u.nk.error("移除失败")}}).catch(()=>{})},C=e=>{p.s.confirm("确定要删除该病人吗？","提示",{type:"warning"}).then(async()=>{try{await s.sQ.removeById(e.id),u.nk.success("删除成功"),h()}catch(a){u.nk.error("删除失败")}}).catch(()=>{})},y=async()=>{r.value&&await r.value.validate(async e=>{if(e)try{await s.sQ.saveOrUpdate(m),u.nk.success("操作成功"),a.value=!1,h()}catch(l){u.nk.error("操作失败")}})},D=()=>{r.value?.resetFields()},_=()=>{h()},w=()=>{h()};return(0,t.sV)(()=>{h()}),{loading:e,dialogVisible:a,caregiverDialogVisible:l,formRef:r,tableData:o,caregiverList:n,formData:m,pagination:b,rules:c,dialogTitle:g,getRelationshipText:f,handleAdd:k,handleEdit:F,handleViewCaregivers:v,handleRemoveCaregiver:V,handleDelete:C,handleSubmit:y,handleDialogClose:D,handleSizeChange:_,handleCurrentChange:w}}},b=l(1241);const c=(0,b.A)(m,[["render",d],["__scopeId","data-v-6867dc59"]]);var g=c}}]);
//# sourceMappingURL=910.9bf08fb4.js.map